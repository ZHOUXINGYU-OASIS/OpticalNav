function H = STT_angle(xs, xa)
%% 计算仅测角的H矩阵
rsx = xs(1);
rsy = xs(2);
rsz = xs(3);
rax = xa(1);
ray = xa(2);
raz = xa(3);
H = zeros(2, 6, 6);
daz_drsx_drsx = -((imag(rax) - imag(rsx) + real(ray) - real(rsy))*(2*imag(ray) - 2*imag(rsy) - 2*real(rax) + 2*real(rsx)))/((imag(rax) - imag(rsx) + real(ray) - real(rsy))^2 + (imag(ray) - imag(rsy) - real(rax) + real(rsx))^2)^2;
daz_drsx_drsy = ((imag(rax) - imag(rsx) + real(ray) - real(rsy))*(2*imag(rax) - 2*imag(rsx) + 2*real(ray) - 2*real(rsy)))/((imag(rax) - imag(rsx) + real(ray) - real(rsy))^2 + (imag(ray) - imag(rsy) - real(rax) + real(rsx))^2)^2 - 1/((imag(rax) - imag(rsx) + real(ray) - real(rsy))^2 + (imag(ray) - imag(rsy) - real(rax) + real(rsx))^2);
daz_drsx_drsz = 0;
daz_drsy_drsx = 1/((imag(rax) - imag(rsx) + real(ray) - real(rsy))^2 + (imag(ray) - imag(rsy) - real(rax) + real(rsx))^2) - ((imag(ray) - imag(rsy) - real(rax) + real(rsx))*(2*imag(ray) - 2*imag(rsy) - 2*real(rax) + 2*real(rsx)))/((imag(rax) - imag(rsx) + real(ray) - real(rsy))^2 + (imag(ray) - imag(rsy) - real(rax) + real(rsx))^2)^2;
daz_drsy_drsy = ((imag(ray) - imag(rsy) - real(rax) + real(rsx))*(2*imag(rax) - 2*imag(rsx) + 2*real(ray) - 2*real(rsy)))/((imag(rax) - imag(rsx) + real(ray) - real(rsy))^2 + (imag(ray) - imag(rsy) - real(rax) + real(rsx))^2)^2;
daz_drsy_drsz = 0;
daz_drsz_drsx = 0;
daz_drsz_drsy = 0;
daz_drsz_drsz = 0;
delev_drsx_drsx = (real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))) - (real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz)))/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2) - ((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2*((imag((2*rax - 2*rsx)^2/((rax - rsx)^2 + (ray - rsy)^2)^(3/2))/2 + (2*sin(angle((rax - rsx)^2 + (ray - rsy)^2)/2))/abs((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))) - ((real((2*rax - 2*rsx)^2/((rax - rsx)^2 + (ray - rsy)^2)^(3/2))/2 - (2*cos(angle((rax - rsx)^2 + (ray - rsy)^2)/2))/abs((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2) - (real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))^2*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^3) + (imag((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2)))/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2) - ((imag((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)) + real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz)))*(imag((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))) - (real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2)/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2)^2;
delev_drsx_drsy = (real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))) - (real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz)))/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2) - ((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2*(imag(((2*rax - 2*rsx)*(2*ray - 2*rsy))/((rax - rsx)^2 + (ray - rsy)^2)^(3/2))/(4*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))) - (real(((2*rax - 2*rsx)*(2*ray - 2*rsy))/((rax - rsx)^2 + (ray - rsy)^2)^(3/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(4*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2) + (imag((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2)))/(4*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2) + (imag((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2)))/(4*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2) - (real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^3)))/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2) - ((imag((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)) + real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz)))*(imag((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))) - (real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2)/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2)^2;
delev_drsx_drsz = real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2)) + ((imag((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))) - (real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2))*(2*imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - 2*real(raz) + 2*real(rsz))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2)/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2)^2;
delev_drsy_drsx = (real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))) - (real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz)))/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2) - ((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2*(imag(((2*rax - 2*rsx)*(2*ray - 2*rsy))/((rax - rsx)^2 + (ray - rsy)^2)^(3/2))/(4*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))) - (real(((2*rax - 2*rsx)*(2*ray - 2*rsy))/((rax - rsx)^2 + (ray - rsy)^2)^(3/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(4*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2) + (imag((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2)))/(4*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2) + (imag((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2)))/(4*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2) - (real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^3)))/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2) - ((imag((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)) + real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz)))*(imag((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))) - (real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2)/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2)^2;
delev_drsy_drsy = (real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))) - (real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz)))/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2) - ((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2*((imag((2*ray - 2*rsy)^2/((rax - rsx)^2 + (ray - rsy)^2)^(3/2))/2 + (2*sin(angle((rax - rsx)^2 + (ray - rsy)^2)/2))/abs((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))) - ((real((2*ray - 2*rsy)^2/((rax - rsx)^2 + (ray - rsy)^2)^(3/2))/2 - (2*cos(angle((rax - rsx)^2 + (ray - rsy)^2)/2))/abs((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2) - (real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))^2*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^3) + (imag((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2)))/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2) - ((imag((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)) + real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz)))*(imag((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))) - (real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2)/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2)^2;
delev_drsy_drsz = real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2)) + ((imag((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))) - (real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)))/(2*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2))*(2*imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - 2*real(raz) + 2*real(rsz))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2)/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2)^2;
delev_drsz_drsx = ((imag((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)) + real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz)))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz)))/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2)^2 - real((2*rax - 2*rsx)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2));
delev_drsz_drsy = ((imag((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz)) + real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz)))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz)))/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2)^2 - real((2*ray - 2*rsy)/((rax - rsx)^2 + (ray - rsy)^2)^(1/2))/(2*((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2));
delev_drsz_drsz = -((2*imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - 2*real(raz) + 2*real(rsz))*(real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz)))/((real(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) + imag(raz) - imag(rsz))^2 + (imag(((rax - rsx)^2 + (ray - rsy)^2)^(1/2)) - real(raz) + real(rsz))^2)^2;
H(1,1:3,1:3) = [daz_drsx_drsx, daz_drsx_drsy, daz_drsx_drsz;
                daz_drsy_drsx, daz_drsy_drsy, daz_drsy_drsz;
                daz_drsz_drsx, daz_drsz_drsy, daz_drsz_drsz];
H(2,1:3,1:3) = [delev_drsx_drsx, delev_drsx_drsy, delev_drsx_drsz;
                delev_drsy_drsx, delev_drsy_drsy, delev_drsy_drsz;
                delev_drsz_drsx, delev_drsz_drsy, delev_drsz_drsz];